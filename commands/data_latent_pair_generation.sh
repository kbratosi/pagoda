DEFAULT_FLAGS="--xz_type=npz --map_location=cuda --use_MPI=True --use_fp16=True --num_workers=16 --sampling_batch=8 --num_heun_step=17 --num_heun_step_random=False --dev_log=True --heun_step_strategy=weighted --start_heun_step=3 --save_png=True --check_dm_performance=False --intermediate_samples=True --eval_fid=False --eval_similarity=False --class_cond=True"
DECODER_FLAGS="--decoder_style=unet --decoder_training=True --decoder_discriminator_training=True --gan_major=True --use_encoder_ema_for_decoder_train=True --decoder_distill_weight=1.0 --decoder_distill_frequency=1 --decoder_gan_frequency=1 --discriminator_weight=1.0 --decoder_fKL_weight=0.0 --decoder_discriminator_initiate_itr=0 --stage_2_itr=-1"
CHANGEABLE_FLAGS="--device_id=0 --port 128 --gpu_usage=True --microbatch 4 --global_batch_size=4 --eval_decoder_interval=1000 --eval_ode_interval=50000 --save_interval=10000 --eval_batch=2500 --eval_num_samples=50000 --sample_interval=1000 --save_period=1000 --log_interval=100"
# CKPT_FLAGS="--out_dir YOUR_OUT_DIR --ref_path FID_STATS_PATH --data_dir ~/datasets/imagenet --xz_data_dir DIR"
PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True
echo $PYTORCH_CUDA_ALLOC_CONF
python data_gather_reverse.py $DEFAULT_FLAGS $DECODER_FLAGS $CHANGEABLE_FLAGS $CKPT_FLAGS --flip_ratio=0.0 --reverse=True --deterministic=True --class_start=0 --class_end=100 --data_dir /data/datasets/ILSVRC/Data/CLS-LOC/train --out_dir out/ --model_path=models/edm_imagenet64_ema.pt --training_mode=edm --class_cond=True --batch_size=500 --eval_num_samples=100000 --stochastic_seed=False --save_format=npz --ind_1=5 --ind_2=3 --use_MPI=True --sampler=heun --sampling_steps=40 --device_id=0